{% extends 'base_content.html' %}
{% block content %}

<style>

    table{
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    td {
    padding: 12px; 
    margin: 4px;
    text-align: center;
    border-bottom: 1px solid rgb(214, 214, 214); 
    }
    th {
        text-align: center;
        padding: 12px; 
        margin: 4px;
        color: white;
        border-bottom: 2px solid rgb(209, 209, 209);
        background-color: rgb(46, 46, 44);
    }

    .remove-button {
        background-color: #cb0808; /* Red background color */
        color: #fff; /* White text color */
        border: none;
        padding: 8px 12px; /* Adjust padding as needed */
        cursor: pointer;
        border-radius: 4px; /* Optional: Add rounded corners */
    }

    .remove-button:hover {
        background-color: #880303; /* Darker red on hover */
    }

</style>

<div class="container">
    <div class="row">
        <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12" id="show-team-table">
            <h1>Team {{team.team_name}}</h1>
            <!--Show the team members in the team as a list-->
            <table>
                <thead>
                    <tr>
                        <th>Username</th>
                        {% if is_admin %}
                            <th>Action</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for member in team_members %}
                        <tr>
                            <td>
                                {% if member == team.admin_user %}
                                    {{ member.username }} (Admin)</td>
                                {% else %}
                                    {{ member.username }}</td>
                            {% endif %}
                            </td>
                            {% if is_admin %}
                                {% if member != team.admin_user %}
                                    <td>
                                        <form method="post" action="{% url 'remove_member' team_id=team.id member_username=member.username %}">
                                        {% csrf_token %}
                                        <button class="remove-button" type="submit">Remove</button>
                                        </form>
                                    </td>
                                    {% endif %}
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            
    <!--Use code from finding all the users, and filter and find only those who are not in the same team as the current user-->
        </div>
        <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
            <form class="d-flex" method="POST" action="{% url 'show_team' team_id=team.id  %}">
                {% csrf_token %}
                <input class="form-control me-2" type="search" id="query" name="q" placeholder="Search...">
                <button class="btn btn-outline-secondary">Search</button>
            </form>

            {% if q %}

                <h2>Users: {{q}}</h2>
                <br/>
                <div class="list-group">
                    {% for user in users %}
                        {% if not user in team_members %}
                            <li class="list-group-item">{{ user.first_name }} {{ user.last_name }} : {{ user.username }}
                                <form method="POST" action="">
                                    {% csrf_token %}
                                    {% if is_admin %}
                                        <input type = "hidden" name="userToAdd" value="{{user}}"/>
                                        <input type="submit" class="btn btn-outline-success" value="Add to Team"/>
                                    {% endif %}
                                </form>
                            </li>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endif%}
        </div>
        
        </div>
    </div>
</div>
    
{% endblock %}  
